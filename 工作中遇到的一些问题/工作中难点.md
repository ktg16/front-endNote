（跳转到ifame keepalive 失效了）

使用keepAlive 后 跳转iframe的页面 返回来会重刷页面(导致缓存失效了)

https://www.jb51.net/article/165976.htm

https://blog.csdn.net/weixin_44490109/article/details/110191582

https://blog.csdn.net/weixin_45514326/article/details/117079393

socket的连接

echarts切换时的卸载

## vue的权限设计

1.获取用户信息

1.创建vue实例的时候将vue-router挂载，但这个时候vue-router挂载一些登录或者不用权限的公用的页面。

2.当用户登录后，获取用role，**将role和路由表每个页面的需要的权限作比较**，生成最终用户可访问的路由表。

3.调用router.addRoutes(store.getters.addRouters)添加用户可访问的路由。

4.使用vuex管理路由表，根据vuex中可访问的路由渲染侧边栏组件。

https://juejin.cn/post/6844903478880370701#heading-7

addRouter + vuex 

根据his写一版完整的权限设计

1.登录之后 依据account调用拿权限的接口（接口返回的事用户所需要的btn（路由按钮））

```javascript
								let btns = []
                                    let pages = []
                                    let pages2 = []
                                    for (let i = 0; i < res.Data.length; i++) {
                                        let item = res.Data[i]
                                        if (item.FormName !== 'MainForm') { // 判断FormName是不是主页 MainForm（代表着该Btnid存在于主页）
                                            if (item.NoPermissionType === '隐藏') {
                                                btns.push(item.BtnID) // 按钮id存入数组
                                            }
                                        } else {
                                            if (item.NoPermissionType === '隐藏') {
                                                let split = item.ButtonName.split("-")[3] // name截取下来
                                                if (pages.length > 35) {// 不知道为什么,应该是超过省略
                                                    pages2.push(split)
                                                } else {
                                                    pages.push(split)
                                                }
                                            }
                                        }
                                    }
								// 只是将数据存了起来
                                    setPermissionBtn(btns) //(按钮权限)在这里用了lowdb把数据存了起来
                                    setPermissionPage(pages) // 存在了cookie里面了
                                    setPermissionPage2(pages2)
                                    console.log('hkj', pages, pages2)

                                    setUserInfo(response.Data.Account, this.loginForm.userId, response.Data.UserName, response.Data.UserToken, this.cid.id, this.cid.clinicname, this.loginForm.password)// 用户信息存到cookie中 cookie需要设置到期时间
//Cookies.set(Account, account, {expires: 999})
                                    //初始化储存身份信息与跳转页面
                                    this.getInitialization()
//渲染的时候从持久化数据里面取出就可以使用了
//路由直接过滤掉 不让其显示 但是挂在在页面上了
v-pre
用的是 d2框架 包含了这一操作
```

依次调用的接口

/api/Auth/CX00101?SystemNameSpace=Enssi3  get id token  account 93(可能是一个标记)

/api/user/CX00216      get Button 是否隐藏

enssihis/doctor/find/userid/

/enssihis/users/findUserAndDeptByID

enssihis/ybbase/setSignIn

enssihis/enssiApi/websocket/ybinterface/webuserlogin